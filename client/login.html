<!DOCTYPE html>
<html>
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <meta charset="utf-8">
    <title>Login</title>
  </head>
  <body>
    <form id="login-form" >
      Username : <br>
      <input type="text" name="username"> <br>
      Password : <br>
      <input type="text" name="password"> <br>
      <button type="submit" name="submit">Submit</button>
    </form>
    <a href="register.html">register</a>
  </body>

  <script type="text/javascript">
      $(document).ready(function() {
        if (localStorage.getItem('fbaccesstoken') != null || localStorage.getItem('accesstoken') != null) {
          window.location.href="index.html"
        }
        $('#login-form').on('submit', function(e){
          e.preventDefault();
          $.ajax({
            method: 'post',
            url: 'http://localhost:3000/user/login',
            data: {
              username: $('#login-form').find('input[name="username"]').val(),
              password: $('#login-form').find('input[name="password"]').val()
            }
          })
          .done(function(data) {
            console.log(data+' ===================');
            localStorage.setItem('accesstoken', data)
            if (data.msg == 'login success') {
              localStorage.setItem('accesstoken', data.data)
              document.location.href="index.html"
            }
            else if (data.msg == 'password incorrect') {
              alert(data.msg)
              document.location.href="index.html"
            }
            else if (data.msg == 'username not found') {
              alert(data.msg)
              document.location.href="index.html"
            }
          })
        });
      });
    </script>

</html>
